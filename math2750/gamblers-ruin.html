<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Gambler’s ruin | Introduction to Markov Processes</title>
  <meta name="description" content="3 Gambler’s ruin | Introduction to Markov Processes" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Gambler’s ruin | Introduction to Markov Processes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Gambler’s ruin | Introduction to Markov Processes" />
  
  
  

<meta name="author" content="Dr Matthew Aldridge m.aldridge@leeds.ac.uk" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="random-walk.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About the module</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organisation-of-the-module"><i class="fa fa-check"></i>Organisation of the module</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lectures"><i class="fa fa-check"></i>Lectures</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#problem-sheets"><i class="fa fa-check"></i>Problem sheets</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#workshops"><i class="fa fa-check"></i>Workshops</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#assessments"><i class="fa fa-check"></i>Assessments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computer-practicals"><i class="fa fa-check"></i>Computer practicals</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#exam"><i class="fa fa-check"></i>Exam</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#office-hours"><i class="fa fa-check"></i>Office hours</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#content-of-the-module"><i class="fa fa-check"></i>Content of the module</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#books"><i class="fa fa-check"></i>Books</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="stochastic-processes-and-the-markov-property.html"><a href="stochastic-processes-and-the-markov-property.html"><i class="fa fa-check"></i><b>1</b> Stochastic processes and the Markov property</a><ul>
<li class="chapter" data-level="1.1" data-path="stochastic-processes-and-the-markov-property.html"><a href="stochastic-processes-and-the-markov-property.html#deterministic-and-random-models"><i class="fa fa-check"></i><b>1.1</b> Deterministic and random models</a></li>
<li class="chapter" data-level="1.2" data-path="stochastic-processes-and-the-markov-property.html"><a href="stochastic-processes-and-the-markov-property.html#stochastic-processes"><i class="fa fa-check"></i><b>1.2</b> Stochastic processes</a></li>
<li class="chapter" data-level="1.3" data-path="stochastic-processes-and-the-markov-property.html"><a href="stochastic-processes-and-the-markov-property.html#markov-property"><i class="fa fa-check"></i><b>1.3</b> Markov property</a></li>
</ul></li>
<li class="part"><span><b>I Part I: Discrete time Markov chains</b></span></li>
<li class="chapter" data-level="2" data-path="random-walk.html"><a href="random-walk.html"><i class="fa fa-check"></i><b>2</b> Random walk</a><ul>
<li class="chapter" data-level="2.1" data-path="random-walk.html"><a href="random-walk.html#simple-random-walk"><i class="fa fa-check"></i><b>2.1</b> Simple random walk</a></li>
<li class="chapter" data-level="2.2" data-path="random-walk.html"><a href="random-walk.html#general-random-walks"><i class="fa fa-check"></i><b>2.2</b> General random walks</a></li>
<li class="chapter" data-level="2.3" data-path="random-walk.html"><a href="random-walk.html#exact-distribution-of-the-simple-random-walk"><i class="fa fa-check"></i><b>2.3</b> Exact distribution of the simple random walk</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gamblers-ruin.html"><a href="gamblers-ruin.html"><i class="fa fa-check"></i><b>3</b> Gambler’s ruin</a><ul>
<li class="chapter" data-level="3.1" data-path="gamblers-ruin.html"><a href="gamblers-ruin.html#gamblers-ruin-markov-chain"><i class="fa fa-check"></i><b>3.1</b> Gambler’s ruin Markov chain</a></li>
<li class="chapter" data-level="3.2" data-path="gamblers-ruin.html"><a href="gamblers-ruin.html#probability-of-ruin"><i class="fa fa-check"></i><b>3.2</b> Probability of ruin</a></li>
<li class="chapter" data-level="3.3" data-path="gamblers-ruin.html"><a href="gamblers-ruin.html#expected-duration-of-the-game"><i class="fa fa-check"></i><b>3.3</b> Expected duration of the game</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Markov Processes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="gamblers-ruin" class="section level1">
<h1><span class="header-section-number">3</span> Gambler’s ruin</h1>
<ul>
<li>The gambler’s ruin Markov chain</li>
<li>Equations for probability of ruin and expected duration of the game by conditioning on the first step</li>
</ul>
<div id="gamblers-ruin-markov-chain" class="section level2">
<h2><span class="header-section-number">3.1</span> Gambler’s ruin Markov chain</h2>
<p>Consider the following gambling problem. Alice is gambling against Bob. Alice starts with £<span class="math inline">\(a\)</span> and Bob starts with £<span class="math inline">\(b\)</span>. It will be convenient to write <span class="math inline">\(m = a + b\)</span> for the total amount of money, so Bob starts with £<span class="math inline">\((m-a)\)</span>. At each step of the game, both players bet £<span class="math inline">\(1\)</span>; Alice wins £<span class="math inline">\(1\)</span> off Bob with probability <span class="math inline">\(p\)</span>, or Bob wins £<span class="math inline">\(1\)</span> off Alice with probability <span class="math inline">\(q\)</span>. The game continues until one player is out of money.</p>
<p>Let <span class="math inline">\(X_n\)</span> denote how much money Alice has after <span class="math inline">\(n\)</span> steps of the game. We can write this as a stochastic process with discrete time <span class="math inline">\(n = \{0,1,2,\dots\} = \mathbb Z_+\)</span> and discrete state space <span class="math inline">\(\mathcal S = \{0,1,\dots,m\}\)</span>, where <span class="math inline">\(X_0 = a\)</span> and, for <span class="math inline">\(n \geq 0\)</span>, we have <span class="math display">\[ X_{n+1} = \begin{cases} X_n + 1 &amp; \text{with probability $p$ if $1\leq X_n \leq m-1$,} \\
                           X_n - 1 &amp; \text{with probability $q$ if $1\leq X_n \leq m-1$,} \\
                           0       &amp; \text{if $X_n = 0$,} \\
                           m       &amp; \text{if $X_n = m$.} \end{cases} \]</span> Note also that the gambler’s ruin process <span class="math inline">\((X_n)\)</span> clearly satisfies the Markov property: the next step <span class="math inline">\(X_{n+1}\)</span> depends on where we are now <span class="math inline">\(X_n\)</span>, but, given that, does not depend on how we got here.</p>
<p>The gambler’s ruin process is exactly like a simple random walk started from <span class="math inline">\(X_0 = a\)</span> except that we have <em>absorbing barriers</em> and <span class="math inline">\(0\)</span> and <span class="math inline">\(m\)</span>, where the game stops because one of the players has `ruined’ – that is, lost all their money. (One can also consider random walks with <em>reflecting barriers</em>, that bounce the random walk back into the state space, or <em>mixed barriers</em> that are absorbing or reflecting at random.)</p>
</div>
<div id="probability-of-ruin" class="section level2">
<h2><span class="header-section-number">3.2</span> Probability of ruin</h2>
<p>The gambling game continues until either Alice is ruined (<span class="math inline">\(X_n = 0\)</span>) or Bob is ruined (<span class="math inline">\(X_n = m\)</span>). A natural question to ask is: What is the probability that the game ends in Alice’s ruin?</p>
<p>Let us write <span class="math inline">\(r_i\)</span> for the probability Alice end up ruined if she has £<span class="math inline">\(i\)</span>. Then the probability of ruin for the whole game is <span class="math inline">\(r_a\)</span>, since Alice initially starts with £<span class="math inline">\(a\)</span>. The probability Bob is ruined is <span class="math inline">\(1 - r_a\)</span>, since eventually one of the players must lose.</p>
<p>What can we say about <span class="math inline">\(r_i\)</span>? Clearly we have <span class="math inline">\(r_0 = 1\)</span> and <span class="math inline">\(r_m = 0\)</span>, since this means Alice (<span class="math inline">\(i=0\)</span>) or Bob (<span class="math inline">\(i=m\)</span>) is out of money and is ruined. What about for <span class="math inline">\(1 \leq i \leq m-1\)</span>?</p>
The key is to <em>condition on the first step</em>. That is, we can write
<span class="math display">\[\begin{align}
\mathbb P(\text{ruin}) &amp;= \mathbb P(\text{win first round}) \, \mathbb P(\text{ruin} \mid \text{win first round}) \\
&amp;\qquad{}+ \mathbb P(\text{lose first round}) \, \mathbb P(\text{ruin} \mid \text{lose first round}) \\
&amp;= p\,\mathbb P(\text{ruin} \mid \text{win first round}) + q \,\mathbb P(\text{ruin} \mid \text{lose first round}) .
\end{align}\]</span>
<p>Here we have conditioned on whether Alice wins or loses the first round. More formally, we have used the , which says that if the disjoint events <span class="math inline">\(B_1, \dots, B_k\)</span> cover the whole sample space, then <span class="math display">\[ \mathbb P(A) = \sum_{i=1}^k \mathbb P(A \cap B_i) = \sum_{i=1}^k \mathbb P(B_i) \, \mathbb P(A \mid B_i) . \]</span> This idea of conditioning on the first step will be a crucial tool throughout this module.</p>
<p>Note that if Alice wins the first round from having £<span class="math inline">\(i\)</span>, she now has £<span class="math inline">\((i+1)\)</span>. By the Markov property, we now see that her probability of ruin is <span class="math inline">\(r_{i+1}\)</span>, because it’s as if the game were starting again with Alice having £<span class="math inline">\((i+1)\)</span> to start with. The Markov property tells us that it doesn’t matter  Alice got to having £<span class="math inline">\((i+1)\)</span>, it only matters how much she has now. Similarly, if Alice loses the first round, she now has £<span class="math inline">\((i-1)\)</span>, and the ruin probability is <span class="math inline">\(r_{i-1}\)</span>. Hence we have <span class="math display">\[ r_i = pr_{i+1} + qr_{i-1}. \]</span></p>
<p>Rearranging, and including the <em>boundary conditions</em>, we see that the equation we want to solve is <span class="math display">\[ pr_{i+1} - r_i + qr_{i-1} = 0 \qquad \text{subject to} \qquad r_0 = 1,\ r_m = 0. \]</span> This is a <em>linear difference equation</em> – and, because the left-hand side is <span class="math inline">\(0\)</span>, we call it a <em>homogeneous</em> linear difference equation. We will see how to solve this equation in the next lecture. We will see that, if we set <span class="math inline">\(\rho = q/p\)</span>, then the ruin probability is given by <span class="math display">\[ r_a = \begin{cases} \displaystyle\frac{\rho^a - \rho^m}{1 - \rho^m} &amp; \text{if $\rho \neq 1$,} \\[0.35cm]
           1 - \displaystyle\frac{a}{m} &amp; \text{if $\rho = 1$.} \end{cases} \]</span> Note that <span class="math inline">\(\rho = 1\)</span> is the same as the condition <span class="math inline">\(p = q = 1/2\)</span>.</p>
<p>Imagine Alice is not playing against her opponent Bob, but rather is up against a large casino. In this case, the casino’s capital £<span class="math inline">\((m-a)\)</span> is typically much bigger than Alice’s £<span class="math inline">\(a\)</span>. We can model this by keeping <span class="math inline">\(a\)</span> fixed taking a limit <span class="math inline">\(m \to \infty\)</span>. Typically, the casino has `an edge’, meaning that <span class="math inline">\(q &gt; p\)</span>, so <span class="math inline">\(\rho &gt; 1\)</span>. In this case, we see that the ruin probability is <span class="math display">\[ \lim_{m \to \infty} r_a = \lim_{m \to \infty} \frac{\rho^a - \rho^m}{1 - \rho^m} = \lim_{m \to \infty} \frac{\rho^a/\rho^m - 1}{1/\rho^m - 1} = \frac{0-1}{0-1} = 1, \]</span> so Alice will be ruined with certainty.</p>
<p>Even with a generous casino that offers an exactly fair game with <span class="math inline">\(p = q\)</span>, so <span class="math inline">\(\rho = 1\)</span>, we have <span class="math display">\[ \lim_{m \to \infty} r_a = \lim_{m \to \infty}\left( 1 - \frac{a}{m} \right) = 1-0 = 1 , \]</span> so, even with this fair game, Alice will still certainly be ruined.</p>
</div>
<div id="expected-duration-of-the-game" class="section level2">
<h2><span class="header-section-number">3.3</span> Expected duration of the game</h2>
<p>We could also ask for how long we expect the game to last.</p>
We approach this like before. Let <span class="math inline">\(d_i\)</span> be the expected duration of the game when Alice has £<span class="math inline">\(i\)</span>. Our boundary conditions are <span class="math inline">\(d_0 = d_m = 0\)</span>, because <span class="math inline">\(X_n = 0\)</span> or <span class="math inline">\(m\)</span> means that the game is over. Again, we proceed by conditioning on the first step, so
<span class="math display">\[\begin{align}
\mathbb E(\text{duration}) &amp;= \mathbb P(\text{win first round}) \, \mathbb E(\text{duration} \mid \text{win first round}) \\
&amp;\qquad{}+ \mathbb P(\text{lose first round}) \, \mathbb E(\text{duration} \mid \text{lose first round}) \\
&amp;= p\,\mathbb E(\text{duration} \mid \text{win first round}) + q \,\mathbb E(\text{duration} \mid \text{lose first round}) .
\end{align}\]</span>
<p>More formally, we’ve used another version of the law of total probability, <span class="math display">\[ \mathbb E(X) = \sum_{i=1}^k \mathbb P(B_i) \, \mathbb E(X \mid B_i) , \]</span> or, alternatively, the  for expectations <span class="math display">\[ \mathbb E(X) = \mathbb E_Y \mathbb E (X \mid Y) = \sum_{y} \mathbb P(Y= y)\, E(X \mid Y = y)\]</span></p>
<p>Now, the expected duration given we win the first round is <span class="math inline">\(1 + d_{i+1}\)</span>. This is because the round itself takes <span class="math inline">\(1\)</span> time step, and then by the Markov property, it’s as if we are starting again from <span class="math inline">\(i+1\)</span>. Similarly, the expected duration given we lose the first round is <span class="math inline">\(1 + d_{i-1}\)</span>. Thus we have <span class="math display">\[ d_i = p(1 + d_{i+1}) + q (1 + d_{i-1}) = 1 + pd_{i+1} + qd_{i-1} . \]</span></p>
<p>Rearranging, and including the boundary conditions, we have another linear difference equation: <span class="math display">\[ pd_{i+1} - d_i + qd_{i-1} = -1 \qquad \text{subject to} \qquad d_0 = 0,\ d_m = 0. \]</span> Because the right-hand side, <span class="math inline">\(-1\)</span>, is nonzero, we call this an <em>inhomogeneous</em> linear difference equation. Again, we’ll see how to solve this in the next lecture, and will find that the solution is given by <span class="math display">\[ d_a = \begin{cases} {\displaystyle \frac{1}{q-p} \left(a - m\frac{1-\rho^a}{1- \rho^m} \right)} &amp; \text{if $\rho \neq 1$,} \\[0.35cm]
\displaystyle a(m-a) &amp; \text{if $\rho = 1$.} \end{cases} \]</span></p>
<p>Thinking again of playing against the casino, with <span class="math inline">\(q &gt; p\)</span>, <span class="math inline">\(\rho &gt; 1\)</span>, and <span class="math inline">\(m \to \infty\)</span>, we see that the expected duration is <span class="math display">\[ \lim_{m\to\infty} d_a = \lim_{m\to\infty} \frac{1}{q-p} \left(a - m\frac{1-\rho^a}{1 - \rho^m} \right)  = \frac{1}{q-p} \left(a - 0 \right) = \frac{a}{q-p} , \]</span> since <span class="math inline">\(\rho^m\)</span> grows much quicker than <span class="math inline">\(m\)</span>. So Alice ruins with certainty, and will take time <span class="math inline">\(a/(q-p)\)</span>, on average.</p>
<p>In the case of the generous casino, though, with <span class="math inline">\(q = p\)</span>, so <span class="math inline">\(\rho = 1\)</span>, we have <span class="math display">\[ \lim_{m\to\infty} d_a =  \lim_{m\to\infty} a(m-a) = \infty .  \]</span> So here, Alice will ruin with certainty, but it may take a very long time until the ruin occurs, since the average duration is infinite.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="random-walk.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
