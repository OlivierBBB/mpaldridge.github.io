<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Linear difference equations | MATH2750 Introduction to Markov Processes</title>
  <meta name="description" content="4 Linear difference equations | MATH2750 Introduction to Markov Processes" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Linear difference equations | MATH2750 Introduction to Markov Processes" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Linear difference equations | MATH2750 Introduction to Markov Processes" />
  
  
  

<meta name="author" content="Matthew Aldridge" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gamblers-ruin.html"/>
<link rel="next" href="how-to-solve-linear-difference-equations.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>MATH2750 notes</b></a></li>

<li class="divider"></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About the module</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organisation-of-the-module"><i class="fa fa-check"></i>Organisation of the module</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lectures"><i class="fa fa-check"></i>Lectures</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#problem-sheets"><i class="fa fa-check"></i>Problem sheets</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#workshops"><i class="fa fa-check"></i>Workshops</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#assessments"><i class="fa fa-check"></i>Assessments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#computer-practicals"><i class="fa fa-check"></i>Computer practicals</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#exam"><i class="fa fa-check"></i>Exam</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#office-hours"><i class="fa fa-check"></i>Office hours</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#content-of-the-module"><i class="fa fa-check"></i>Content of the module</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#books"><i class="fa fa-check"></i>Books</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="stochastic-processes-and-the-markov-property.html"><a href="stochastic-processes-and-the-markov-property.html"><i class="fa fa-check"></i><b>1</b> Stochastic processes and the Markov property</a><ul>
<li class="chapter" data-level="1.1" data-path="stochastic-processes-and-the-markov-property.html"><a href="stochastic-processes-and-the-markov-property.html#deterministic-and-random-models"><i class="fa fa-check"></i><b>1.1</b> Deterministic and random models</a></li>
<li class="chapter" data-level="1.2" data-path="stochastic-processes-and-the-markov-property.html"><a href="stochastic-processes-and-the-markov-property.html#stochastic-processes"><i class="fa fa-check"></i><b>1.2</b> Stochastic processes</a></li>
<li class="chapter" data-level="1.3" data-path="stochastic-processes-and-the-markov-property.html"><a href="stochastic-processes-and-the-markov-property.html#markov-property"><i class="fa fa-check"></i><b>1.3</b> Markov property</a></li>
</ul></li>
<li class="part"><span><b>Part I: Discrete time Markov chains</b></span></li>
<li class="chapter" data-level="2" data-path="random-walk.html"><a href="random-walk.html"><i class="fa fa-check"></i><b>2</b> Random walk</a><ul>
<li class="chapter" data-level="2.1" data-path="random-walk.html"><a href="random-walk.html#simple-random-walk"><i class="fa fa-check"></i><b>2.1</b> Simple random walk</a></li>
<li class="chapter" data-level="2.2" data-path="random-walk.html"><a href="random-walk.html#general-random-walks"><i class="fa fa-check"></i><b>2.2</b> General random walks</a></li>
<li class="chapter" data-level="2.3" data-path="random-walk.html"><a href="random-walk.html#exact-distribution-of-the-simple-random-walk"><i class="fa fa-check"></i><b>2.3</b> Exact distribution of the simple random walk</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gamblers-ruin.html"><a href="gamblers-ruin.html"><i class="fa fa-check"></i><b>3</b> Gambler’s ruin</a><ul>
<li class="chapter" data-level="3.1" data-path="gamblers-ruin.html"><a href="gamblers-ruin.html#gamblers-ruin-markov-chain"><i class="fa fa-check"></i><b>3.1</b> Gambler’s ruin Markov chain</a></li>
<li class="chapter" data-level="3.2" data-path="gamblers-ruin.html"><a href="gamblers-ruin.html#probability-of-ruin"><i class="fa fa-check"></i><b>3.2</b> Probability of ruin</a></li>
<li class="chapter" data-level="3.3" data-path="gamblers-ruin.html"><a href="gamblers-ruin.html#expected-duration-of-the-game"><i class="fa fa-check"></i><b>3.3</b> Expected duration of the game</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html"><i class="fa fa-check"></i><b>4</b> Linear difference equations</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#homogeneous-linear-difference-equations"><i class="fa fa-check"></i><b>4.1</b> Homogeneous linear difference equations</a></li>
<li class="chapter" data-level="4.2" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#probability-of-ruin-for-the-gamblers-ruin"><i class="fa fa-check"></i><b>4.2</b> Probability of ruin for the gambler’s ruin</a></li>
<li class="chapter" data-level="4.3" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#inhomogeneous-linear-difference-equations"><i class="fa fa-check"></i><b>4.3</b> Inhomogeneous linear difference equations</a></li>
<li class="chapter" data-level="4.4" data-path="linear-difference-equations.html"><a href="linear-difference-equations.html#expected-duration-for-the-gamblers-ruin"><i class="fa fa-check"></i><b>4.4</b> Expected duration for the gambler’s ruin</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="how-to-solve-linear-difference-equations.html"><a href="how-to-solve-linear-difference-equations.html"><i class="fa fa-check"></i>How to solve linear difference equations</a><ul>
<li class="chapter" data-level="" data-path="how-to-solve-linear-difference-equations.html"><a href="how-to-solve-linear-difference-equations.html#how-to-solve-homogeneous-linear-difference-equations"><i class="fa fa-check"></i>How to solve homogeneous linear difference equations</a></li>
<li class="chapter" data-level="" data-path="how-to-solve-linear-difference-equations.html"><a href="how-to-solve-linear-difference-equations.html#how-to-solve-inhomogeneous-linear-difference-equations"><i class="fa fa-check"></i>How to solve inhomogeneous linear difference equations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="discrete-time-markov-chains.html"><a href="discrete-time-markov-chains.html"><i class="fa fa-check"></i><b>5</b> Discrete time Markov chains</a></li>
<li class="chapter" data-level="6" data-path="examples-from-actuarial-science.html"><a href="examples-from-actuarial-science.html"><i class="fa fa-check"></i><b>6</b> Examples from actuarial science</a></li>
<li class="chapter" data-level="7" data-path="class-structure.html"><a href="class-structure.html"><i class="fa fa-check"></i><b>7</b> Class structure</a></li>
<li class="chapter" data-level="8" data-path="hitting-times.html"><a href="hitting-times.html"><i class="fa fa-check"></i><b>8</b> Hitting times</a></li>
<li class="chapter" data-level="9" data-path="recurrence-and-transience.html"><a href="recurrence-and-transience.html"><i class="fa fa-check"></i><b>9</b> Recurrence and transience</a></li>
<li class="chapter" data-level="10" data-path="stationary-distributions.html"><a href="stationary-distributions.html"><i class="fa fa-check"></i><b>10</b> Stationary distributions</a></li>
<li class="chapter" data-level="" data-path="how-to-find-stationary-distributions.html"><a href="how-to-find-stationary-distributions.html"><i class="fa fa-check"></i>How to find stationary distributions</a></li>
<li class="chapter" data-level="11" data-path="long-term-behaviour-of-markov-chains.html"><a href="long-term-behaviour-of-markov-chains.html"><i class="fa fa-check"></i><b>11</b> Long-term behaviour of Markov chains</a></li>
<li class="chapter" data-level="" data-path="summary-of-part-i.html"><a href="summary-of-part-i.html"><i class="fa fa-check"></i>Summary of Part I</a></li>
<li class="part"><span><b>Part II: Continuous time Markov jump processes</b></span></li>
<li class="chapter" data-level="12" data-path="poisson-process-and-the-poisson-distribution.html"><a href="poisson-process-and-the-poisson-distribution.html"><i class="fa fa-check"></i><b>12</b> Poisson process and the Poisson distribution</a></li>
<li class="chapter" data-level="13" data-path="poisson-process-and-the-exponential-distribution.html"><a href="poisson-process-and-the-exponential-distribution.html"><i class="fa fa-check"></i><b>13</b> Poisson process and the exponential distribution</a></li>
<li class="chapter" data-level="14" data-path="poisson-process-in-infinitesimal-time-periods.html"><a href="poisson-process-in-infinitesimal-time-periods.html"><i class="fa fa-check"></i><b>14</b> Poisson process in infinitesimal time periods</a></li>
<li class="chapter" data-level="15" data-path="counting-processes.html"><a href="counting-processes.html"><i class="fa fa-check"></i><b>15</b> Counting processes</a></li>
<li class="chapter" data-level="16" data-path="continuous-time-markov-jump-processes-jump-chain-and-holding-times.html"><a href="continuous-time-markov-jump-processes-jump-chain-and-holding-times.html"><i class="fa fa-check"></i><b>16</b> Continuous time Markov jump processes: jump chain and holding times</a></li>
<li class="chapter" data-level="17" data-path="forward-and-backward-equations.html"><a href="forward-and-backward-equations.html"><i class="fa fa-check"></i><b>17</b> Forward and backward equations</a></li>
<li class="chapter" data-level="18" data-path="class-structure-and-hitting-times.html"><a href="class-structure-and-hitting-times.html"><i class="fa fa-check"></i><b>18</b> Class structure and hitting times</a></li>
<li class="chapter" data-level="19" data-path="long-term-behaviour-of-markov-jump-processes.html"><a href="long-term-behaviour-of-markov-jump-processes.html"><i class="fa fa-check"></i><b>19</b> Long-term behaviour of Markov jump processes</a></li>
<li class="chapter" data-level="20" data-path="queues.html"><a href="queues.html"><i class="fa fa-check"></i><b>20</b> Queues</a></li>
<li class="chapter" data-level="" data-path="summary-of-part-ii.html"><a href="summary-of-part-ii.html"><i class="fa fa-check"></i>Summary of Part II</a></li>
<li class="part"><span><b>Revision</b></span></li>
<li class="chapter" data-level="21" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html"><i class="fa fa-check"></i><b>21</b> Frequently asked questions</a></li>
<li class="chapter" data-level="22" data-path="exam-preparation.html"><a href="exam-preparation.html"><i class="fa fa-check"></i><b>22</b> Exam preparation</a></li>
<li class="divider"></li>
<li><a href="https://mpaldridge.github.io/">Matthew Aldridge</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MATH2750 Introduction to Markov Processes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-difference-equations" class="section level1">
<h1><span class="header-section-number">4</span> Linear difference equations</h1>
<div class="summ">
<p>
How to solve homogeneous and inhomogeneous linear difference equations Solving for probability of ruin and expected duration for the gambler’s ruin
</p>
</div>
<p><em>Linear difference equations</em> are equations that look like <span class="math display">\[ a_k x_{n+k} + a_{k-1} x_{n+k-1} + \cdots + a_1 x_{n+1} + a_0 x_n = f(n)  \qquad (*) \]</span> for <span class="math inline">\(n = 0,1,\dots\)</span>, where the <span class="math inline">\(a_i\)</span> are given constants, <span class="math inline">\(f(n)\)</span> is a given function, and we want to solve for the sequence <span class="math inline">\((x_n)\)</span>. The equation normally comes with some extra conditions, such as the value of the first few <span class="math inline">\(x_n\)</span>s.</p>
<p>When the right-hand side of <span class="math inline">\((*)\)</span> is zero, so <span class="math inline">\(f(n) = 0\)</span>, we say the equation is <em>homogeneous</em>; if the right-hand side is nonzero, it is <em>inhomogeneous</em>. The number <span class="math inline">\(k\)</span>, where there are <span class="math inline">\(k+1\)</span> terms on the left-hand side, is called the <em>degree</em>}* of the equation; we are mostly interested in second-degree linear difference equations.</p>
<p>A handout, <strong>How to solve linear difference equations</strong>, summarises the techniques we will learn in this lecture, and includes some extra examples.</p>
<div id="homogeneous-linear-difference-equations" class="section level2">
<h2><span class="header-section-number">4.1</span> Homogeneous linear difference equations</h2>
<p>We start with the homogeneous case, which is simpler.</p>
<p>Consider a homogeneous linear difference equation. We shall use the second-degree example <span class="math display">\[ x_{n+2} - 5x_{n+1} + 6x_{n} = 0 \qquad \text{subject to } x_0 = 4, x_1 = 9 .  \]</span> Here, the conditions on <span class="math inline">\(x_0\)</span> and <span class="math inline">\(x_1\)</span> are <em>initial conditions</em>, because they tell us how the sequence <span class="math inline">\((x_n)\)</span> starts.</p>
For the moment, we shall put the initial conditions to the side and just worry about the equation <span class="math display">\[ x_{n+2} - 5x_{n+1} + 6x_{n} = 0 . \]</span> We start by guessing there might be a solution of the form <span class="math inline">\(x_n = \lambda^n\)</span> for some constant <span class="math inline">\(\lambda\)</span>. We can find out if there is such a solution by substituting in <span class="math inline">\(x_n = \lambda^n\)</span>, and seeing if there exists a solution for <span class="math inline">\(\lambda\)</span>. For our example, we get <span class="math display">\[ \lambda^{n+2} - 5 \lambda^{n+1} + 6\lambda^n = 0 . \]</span> After cancelling off a common factor of <span class="math inline">\(\lambda^n\)</span>, we get <span class="math display">\[ \lambda^2 - 5 \lambda + 6 = 0 . \]</span> This is called the <em>characteristic equation</em>. For a general homogeneous linear difference equation , the characteristic equation is
<span class="math display">\[\begin{equation} \label {cheq} a_k \lambda^{k} + a_{k-1} \lambda^{k-1} + \cdots + a_1 \lambda + a_0 = 0 . \end{equation}\]</span>
<p>We can now solve the characteristic equation for <span class="math inline">\(\lambda\)</span>. In our example, we can factor the left-hand side to <span class="math inline">\((\lambda - 3)(\lambda - 2) = 0\)</span>, to find the solutions <span class="math inline">\(\lambda = 2\)</span> and <span class="math inline">\(\lambda = 3\)</span>. Thus <span class="math inline">\(x_n = 2^n\)</span> and <span class="math inline">\(x_n = 3^n\)</span> both solve our equation. In fact, since the right-hand side of the equation is <span class="math inline">\(0\)</span>, any linear combination of these two solutions is a solution also, thus we get the <em>general solution</em> <span class="math display">\[ x_n = A 2^n + B 3^n , \]</span> which is a solution for any values of the constants <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<p>For a general characteristic equation with distinct roots <span class="math inline">\(\lambda_1, \lambda_2, \dots, \lambda_k\)</span>, the general solution is <span class="math display">\[ x_n = C_1 \lambda_1^n + C_2 \lambda_2^n + \cdots + C_n \lambda_k^n . \]</span> If we have a repeated root – say, <span class="math inline">\(\lambda_1 = \lambda_2 = \cdots = \lambda_r\)</span> is repeated <span class="math inline">\(r\)</span> times – then you can check that a solution is given by <span class="math display">\[ x_n = (D_0 + D_1 n + \cdots + D_{r-1} n^{r-1}) \lambda_1^n , \]</span> which should take its place in the general solution.</p>
Once we have the general solution, we can use the extra conditions to find the values of the constants. In our example, we can use the initial conditions to find out the values of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. We see that
<span class="math display">\[\begin{gather*}
x_0 = A2^0 + B3^0 = A + B = 4 , \\
x_1 = A2^1 + B3^1 = 2A + 3B = 9 .
\end{gather*}\]</span>
<p>We can now solve this pair of simultaneous equations to solve for <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. By subtracting twice the first equation from the second we get <span class="math inline">\(B = 1\)</span>, and substituting this into the first equation we get <span class="math inline">\(A = 3\)</span>. Thus the solution is <span class="math display">\[ x_n = 3\cdot 2^n + 3^n . \]</span></p>
<p>In conclusion, the process here was:</p>
<ol style="list-style-type: decimal">
<li>Find the general solution by writing down and solving the characteristic equation.</li>
<li>Use the extra conditions to find the values of the constants in the general solution.</li>
</ol>
</div>
<div id="probability-of-ruin-for-the-gamblers-ruin" class="section level2">
<h2><span class="header-section-number">4.2</span> Probability of ruin for the gambler’s ruin</h2>
<p>In the last lecture we saw that probability of ruin for the gambler’s ruin process is the solution to <span class="math display">\[ pr_{i+1} - r_i + qr_{i-1} = 0 \qquad \text{subject to} \qquad r_0 = 1,\ r_m = 0 , \]</span> where the extra conditions here are <em>boundary conditions</em>.</p>
<p>The characteristic equation is <span class="math display">\[ p\lambda^2 - \lambda + q = 0 .\]</span> We can solve the characteristic equation by factorising it as <span class="math inline">\((p \lambda - q)(\lambda - 1) = 0\)</span>. (It might take a moment to check this – we’ve used that <span class="math inline">\(p+q=1\)</span>.) So the characteristic equation has roots <span class="math inline">\(\lambda = q/p\)</span>, which we called <span class="math inline">\(\rho\)</span> last time, and <span class="math inline">\(\lambda = 1\)</span>. Note that if <span class="math inline">\(\rho = 1\)</span> (so <span class="math inline">\(p = q = 1/2\)</span>) we have a repeated root, while if <span class="math inline">\(\rho \neq 1\)</span> we have distinct roots, so we’ll need to deal with the two cases separately.</p>
<p>First, the case <span class="math inline">\(\rho \neq 0\)</span>. Since the two roots are distinct, we have the general solution <span class="math display">\[ r_i = A\rho^i + B1^i = A\rho^i + B . \]</span></p>
We can now use the boundary conditions to find <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. We have
<span class="math display">\[\begin{gather*} r_0 = A \rho^0 + B = A+B = 1, \\
                r_m = A \rho^m + B = 0 . \end{gather*}\]</span>
<p>From the first we get <span class="math inline">\(B = 1-A\)</span>, which we substitute into the second to get <span class="math display">\[ A\rho^m + 1 - A = 0 \quad \Rightarrow \quad A = \frac{1}{1-\rho^m} , \]</span> and hence <span class="math display">\[ B = 1 - A = 1 - \frac{1}{1-\rho^m} = - \frac{\rho^m}{1 - \rho^m} . \]</span> Thus the solution is <span class="math display">\[ r_i = \frac{1}{1-\rho^m} \rho^i -  \frac{\rho^m}{1 - \rho^m} = \frac{\rho^i - \rho^m}{1 - \rho^m}  , \]</span> as we claimed last time.</p>
<p>Second, the case <span class="math inline">\(\rho = 1\)</span>. Now we have a repeated root <span class="math inline">\(\lambda = 1\)</span>, so the general solution is <span class="math display">\[ r_i = (A + Bi) 1^i = A+Bi . \]</span></p>
Again, we use the boundary conditions, to get
<span class="math display">\[\begin{gather*} r_0 = A + B\cdot 0 = A = 1, \\
r_m = A + Bm = 0 , \end{gather*}\]</span>
<p>and we immediately see that <span class="math inline">\(A = 1\)</span> and <span class="math inline">\(B = -1/m\)</span>. Thus the solution is <span class="math display">\[ r_i = 1 - \frac{1}{m}i = 1 - \frac{i}{m} , \]</span> as claimed.</p>
</div>
<div id="inhomogeneous-linear-difference-equations" class="section level2">
<h2><span class="header-section-number">4.3</span> Inhomogeneous linear difference equations</h2>
<p>Solving inhomogeneous linear difference equations requires three steps:</p>
<ol style="list-style-type: decimal">
<li>Find the general solution to the <em>homogeneous</em> equation by writing down and solving the characteristic equation.</li>
<li>Find any solution (a <em>particular solution</em>) to the inhomogeneous equation. The general solution solution to the inhomogeneous equation is a particular solution plus the general solution to the homogeneous equation.</li>
<li>Use the extra conditions to find the values of the constants in the general solution.</li>
</ol>
<p>This idea works because adding a solution to the homogeneous equation to the left-hand side adds zero to the right-hand side.</p>
<p>Let’s work through the example <span class="math display">\[ x_{n+2} - 5x_{n+1} + 6x_{n} = 2 \qquad \text{subject to } x_0 = 4, x_1 = 9 . \]</span></p>
<p>We already know from earlier that the general solution to the homogeneous equation <span class="math inline">\(x_{n+2} - 5x_{n+1} + 6x_{n} - 0\)</span> (with a zero on the right-hand side) is <span class="math display">\[ x_n = A2^n + B3^n . \]</span></p>
<p>We now need to find a <em>particular solution</em> – that is, any solution – to our new inhomogeneous equation. A general hint here is to guess a solution with the same `shape’ as the right-hand side. For example, if the right-hand side is a polynomial of degree <span class="math inline">\(d\)</span>, try a polynomial of degree <span class="math inline">\(d\)</span>. Here our right-hand side is a constant (<span class="math inline">\(2\)</span>), so we should try a constant. Substituting in <span class="math inline">\(x_n = C\)</span> for all <span class="math inline">\(n\)</span> gives us <span class="math inline">\(C - 5C + 6C = 2\)</span>, thus <span class="math inline">\(2C = 2\)</span> and <span class="math inline">\(C = 1\)</span>, giving a particular solution <span class="math inline">\(x_n = 1\)</span>. The general solution to the inhomogeneous equation is therefore <span class="math display">\[ x_n = 1 + A2^n + B3^n . \]</span></p>
Again, we use the initial conditions to get the constants <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. We have
<span class="math display">\[\begin{gather*}
x_0 = 1 + A2^0 + B3^0 = 1+ A + B = 4 , \\
x_1 = 1 + A2^1 + B3^1 = 1+ 2A + 3B = 9 ,
\end{gather*}\]</span>
<p>and we can easily check this gives <span class="math inline">\(A = 1, B = 2\)</span>. Thus the solution is <span class="math display">\[ x_n = 1 + 1\cdot 2^n + 2 \cdot 3^n = 1 + 2^n + 2 \cdot 3^n . \]</span></p>
</div>
<div id="expected-duration-for-the-gamblers-ruin" class="section level2">
<h2><span class="header-section-number">4.4</span> Expected duration for the gambler’s ruin</h2>
<p>From last time, the expected duration of the gambler’s ruin game solves <span class="math display">\[ pd_{i+1} - d_i + qd_{i-1} = -1 \qquad \text{subject to} \qquad d_0 = 0,\ d_m = 0. \]</span> As before, we divide cases based on whether or not <span class="math inline">\(\rho = 1\)</span>.</p>
<p>First, the case <span class="math inline">\(\rho \neq 1\)</span>. We already know that the general solution to the homogeneous equation is <span class="math display">\[ d_i =  A \rho^i + B . \]</span></p>
Now we need a particular solution. It’s tempting to guess a constant <span class="math inline">\(C\)</span> for a particular solution, but we know that constants solve the homogeneous equation, so will have right-hand side <span class="math inline">\(0\)</span>, not <span class="math inline">\(-1\)</span>. The next best guess is one degree up: let’s try <span class="math inline">\(x_i = Ci\)</span>. This gives
<span class="math display">\[\begin{align*}
  -1 &amp;= pC(i+1) - Ci + qC(i-1)\\
     &amp;= C(pi + p - i + qi - q) \\
     &amp;= C\big((p+q-1)i + (p-q)\big) \\
     &amp;= C(p-q) ,
  \end{align*}\]</span>
<p>giving <span class="math inline">\(C = -1/(p-q) = 1/(q-p)\)</span>. The general solution to the inhomogeneous equation is <span class="math display">\[ d_i = \frac{i}{q-p} + A \rho^i + B .  \]</span></p>
Then to find the constants, we have
<span class="math display">\[\begin{gather*} r_0 = \frac{0}{q-p} + A \rho^0 + B = A+B = 0, \\
                  r_m = \frac{m}{q-p} + A \rho^m + B = 0 , \end{gather*}\]</span>
<p>which gives <span class="math display">\[ A = -B = \frac{1}{q-p} \cdot \frac{m}{1 - \rho^m} . \]</span> The solution is <span class="math display">\[ d_i = \frac{i}{q-p} + \frac{1}{q-p} \cdot \frac{m}{1 - \rho^m} \rho^i - \frac{1}{q-p} \cdot \frac{m}{1 - \rho^m} =  \frac{1}{q-p} \left(i - m\frac{1-\rho^i}{1- \rho^m} \right) . \]</span></p>
<p>Second, the case <span class="math inline">\(\rho = 1\)</span>, so <span class="math inline">\(p = q = 1/2\)</span>. We already know that the general solution to the homogeneous equation is <span class="math display">\[ d_i =  A + Bi . \]</span></p>
We need a particular solution. Since both constants and linear terms solve the homogeneous equation, we’ll have to go up another degree and try <span class="math inline">\(x_i = Ci^2\)</span>. This gives
<span class="math display">\[\begin{align*}
    -1 &amp;= \frac12 C(i+1)^2 - Ci^2 + \frac 12 C(i-1)^2 \\
       &amp;= \frac12 C(i^2 + 2i + 1 - 2i^2 + i^2 - 2i + 1) \\
       &amp;= \frac12 C\big((1-2+1)i^2 + (2-2)i + (1+1)\big) \\
       &amp;=C ,
\end{align*}\]</span>
<p>so the general solution to the inhomogeneous equation is <span class="math display">\[ d_i = -i^2 + A + Bi .  \]</span></p>
Then to find the constants, we have
<span class="math display">\[\begin{gather*} d_0 = -0i^2 + A + B\cdot0 = A = 0, \\
                  d_m = -m^2 + A + Bm = 0 , \end{gather*}\]</span>
<p>giving <span class="math inline">\(A = 0, B = m\)</span>. The solution is <span class="math display">\[ d_i = -i^2 + 0 + mi = i(m-i) .\]</span></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gamblers-ruin.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="how-to-solve-linear-difference-equations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
